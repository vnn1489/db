sudo apt install mysql-server
sudo systemctl start mysql.service

sudo mysql
    ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'SetYourPassword';
    exit
sudo mysql_secure_installation

mysql -u root -p

mysql -u root -h 127.0.0.1 -P 3306 -p


CREATE DATABASE `SetNameDb`;
USE `NameDb`;

CREATE TABLE `cards` (
    `id` INT AUTO_INCREMENT,
    PRIMARY KEY(`id`)
);

DESCRIBE `TableName`;

CREATE TABLE `stattions` (
    `id` INT AUTO_INCREMENT,
    `name` VARCHAR(32) NOT NULL UNIQUE,
    `line` ENUM('green', 'reb', 'blue', ...) NOT NULL,
    PRIMARY KEY(`id`)
);

CREATE TABLE `swipes` (
    `id` INT AUTO_INCREMENT,
    `card_id` INT,
    `stattion_id` INT,
    `type` ENUM('enter', 'exit', 'deposit') NOT NULL,
    `datetime` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    `amount` DECIMAL(5,2) NOT NULL CHECK(`amount` != 0),
    PRIMARY KEY(`id`),
    FOREIGN KEY(`card_id`) REFERENCES `cards`(`id`),
    FOREIGN KEY(`stattion_id`) REFERENCES `stattions`(`id`)  
);

ALTER TABLE `stattions` MODIFY `line` ENUM('red', 'green', 'blue', 'silver') NOT NULL; ---> ADD silver CHOOSE INTO DB 


---- STORED PROCEDURES ----
ALTER TABLE `collections` ADD COLUMN deleted TINYINT DEFAULT 0;

delimiter //
CREATE PROCEDURE `current_collection`()
    BEGIN
    SELECT `title`, `accession_number`, `acquired`
    FROM `collections` WHERE `deleted` = 0;
    END//
delimiter ;

CALL `current_collection`();

UPDATE `collections` SET `deleted` = 1 WHERE `title` = 'Vu Nguyen Nguyen';

CREATE TABLE `transactions` (
    `id` INT AUTO_INCREMENT,
    `title` VARCHAR(64) NOT NULL,
    `action` ENUM('bought', 'sold') NOT NULL,
    PRIMARY KEY(`id`)
);

delimiter //
CREATE PROCEDURE `sell`(IN `sold_id` INT)
    BEGIN
    UPDATE `collections` SET `deleted` = 1
    WHERE `id` = `sold_id`;
    INSERT INTO `transactions` (`title`, `action`)
    VALUES((SELECT `title` FROM `collections` WHERE `id` = `sold_id`), 'sold');
    END//
delimiter ;

CALL `sell`(2);

