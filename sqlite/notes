https://cs50.harvard.edu/sql/2023/psets/1/

SELECT schools.name, expenditures.per_pupil_expenditure, graduation_rates.graduated
FROM schools
JOIN expenditures ON schools.district_id = expenditures.district_id
JOIN graduation_rates ON schools.id = graduation_rates.school_id
ORDER BY expenditures.per_pupil_expenditure DESC, schools.name ASC;



SELECT * FROM expenditures WHERE per_pupil_expenditure > (SELECT AVG(per_pupil_expenditure) FROM expenditures);
SELECT * FROM staff_evaluations WHERE exemplary > (SELECT AVG(exemplary) FROM staff_evaluations);
SELECT * FROM districts WHERE name LIKE '%(District)%';

 ON expenditures.district_id = districts.id 
 ON staff_evaluations.district_id = districts.id;

SELECT * FROM schools WHERE district_id IN (
SELECT district_id
FROM districts
NATURAL JOIN expenditures
NATURAL JOIN staff_evaluations
WHERE expenditures.per_pupil_expenditure > (SELECT AVG(per_pupil_expenditure) FROM expenditures)
AND staff_evaluations.exemplary > (SELECT AVG(exemplary) FROM staff_evaluations)
);


SELECT *
FROM districts
JOIN schools ON schools.district_id = districts.id
JOIN expenditures ON expenditures.district_id
JOIN staff_evaluations ON staff_evaluations.district_id
WHERE districts.type IS 'Public School District';


SELECT district_id
FROM districts
NATURAL JOIN expenditures
NATURAL JOIN staff_evaluations
WHERE expenditures.per_pupil_expenditure > (SELECT AVG(per_pupil_expenditure) FROM expenditures)
AND staff_evaluations.exemplary > (SELECT AVG(exemplary) FROM staff_evaluations);





rm /

rm ./







